<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Compound Interest Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <div id="compound-interest-calculator">
      <h2>Compound Interest Calculator</h2>

      <div class="input-group">
        <label for="initial-deposit">Initial deposit:</label>
        <input type="number" id="initial-deposit" value="10000" />
      </div>

      <div class="input-group">
        <label for="regular-deposit">Regular deposit:</label>
        <input type="number" id="regular-deposit" value="0" />
      </div>

      <div class="input-group">
        <label for="years">Number of years:</label>
        <input type="number" id="years" value="1" min="1" max="50" />
      </div>

      <div class="input-group">
        <label for="interest-rate">Annual interest rate (%):</label>
        <input
          type="number"
          id="interest-rate"
          value="5"
          step="0.01"
          min="0"
          max="20"
        />
      </div>

      <div class="input-group">
        <label for="deposit-frequency">Deposit frequency:</label>
        <select id="deposit-frequency">
          <option value="monthly">Monthly</option>
          <option value="annually">Annually</option>
          <option value="semi-annually">Semi-annually</option>
          <option value="quarterly">Quarterly</option>
          <option value="weekly">Weekly</option>
          <option value="daily">Daily</option>
        </select>
      </div>

      <div class="input-group">
        <label for="compound-frequency">Compound frequency:</label>
        <select id="compound-frequency">
          <option value="monthly">Monthly</option>
          <option value="annually">Annually</option>
          <option value="semi-annually">Semi-annually</option>
          <option value="quarterly">Quarterly</option>
          <option value="weekly">Weekly</option>
          <option value="daily">Daily</option>
        </select>
      </div>

      <div id="results"></div>

      <canvas id="chart"></canvas>
    </div>

    <script>
      // Get DOM elements
      const initialDepositInput = document.getElementById("initial-deposit");
      const regularDepositInput = document.getElementById("regular-deposit");
      const yearsInput = document.getElementById("years");
      const interestRateInput = document.getElementById("interest-rate");
      const depositFrequencySelect =
        document.getElementById("deposit-frequency");
      const compoundFrequencySelect =
        document.getElementById("compound-frequency");
      const resultsDiv = document.getElementById("results");

      let chart;

      // Add event listeners to inputs
      [
        initialDepositInput,
        regularDepositInput,
        yearsInput,
        interestRateInput,
        depositFrequencySelect,
        compoundFrequencySelect,
      ].forEach((element) => {
        element.addEventListener("input", calculateCompoundInterest);
      });

      function calculateCompoundInterest() {
        const initialDeposit = parseFloat(initialDepositInput.value);
        const regularDeposit = parseFloat(regularDepositInput.value);
        const years = parseInt(yearsInput.value);
        const annualInterestRate = parseFloat(interestRateInput.value) / 100;
        const depositFrequency = getFrequencyValue(
          depositFrequencySelect.value
        );
        const compoundFrequency = getFrequencyValue(
          compoundFrequencySelect.value
        );

        let totalAmount = initialDeposit;
        const periodsPerYear = compoundFrequency;
        const totalPeriods = years * periodsPerYear;
        const interestRatePerPeriod = annualInterestRate / periodsPerYear;

        let yearlyData = [{ x: 0, y: initialDeposit }];

        for (let i = 0; i < totalPeriods; i++) {
          totalAmount *= 1 + interestRatePerPeriod;
          if (i % (periodsPerYear / depositFrequency) === 0) {
            totalAmount += regularDeposit;
          }
          if ((i + 1) % periodsPerYear === 0) {
            yearlyData.push({ x: (i + 1) / periodsPerYear, y: totalAmount });
          }
        }

        const totalInterest =
          totalAmount -
          initialDeposit -
          regularDeposit * years * depositFrequency;
        const totalDeposits =
          initialDeposit + regularDeposit * years * depositFrequency;

        displayResults(totalAmount, totalInterest, totalDeposits);
        updateChart(yearlyData, totalDeposits, totalInterest);
      }

      function getFrequencyValue(frequency) {
        switch (frequency) {
          case "annually":
            return 1;
          case "semi-annually":
            return 2;
          case "quarterly":
            return 4;
          case "monthly":
            return 12;
          case "weekly":
            return 52;
          case "daily":
            return 365;
          default:
            return 12; // Default to monthly
        }
      }

      function displayResults(totalAmount, totalInterest, totalDeposits) {
        resultsDiv.innerHTML = `
        <p>Total savings: $${totalAmount.toFixed(2)}</p>
        <p>Total deposits: $${totalDeposits.toFixed(2)}</p>
        <p>Total interest: $${totalInterest.toFixed(2)}</p>
    `;
      }

      function updateChart(data, totalDeposits, totalInterest) {
        const ctx = document.getElementById("chart").getContext("2d");

        if (chart) {
          chart.destroy();
        }

        chart = new Chart(ctx, {
          type: "bar",
          data: {
            datasets: [
              {
                label: "Total Savings",
                data: data,
                backgroundColor: "rgba(0, 123, 255, 0.5)",
                borderColor: "rgba(0, 123, 255, 1)",
                borderWidth: 1,
              },
            ],
          },
          options: {
            responsive: true,
            scales: {
              x: {
                type: "linear",
                position: "bottom",
                title: {
                  display: true,
                  text: "Years",
                },
              },
              y: {
                beginAtZero: true,
                title: {
                  display: true,
                  text: "Amount ($)",
                },
              },
            },
            plugins: {
              tooltip: {
                callbacks: {
                  label: function (context) {
                    let label = context.dataset.label || "";
                    if (label) {
                      label += ": ";
                    }
                    if (context.parsed.y !== null) {
                      label += new Intl.NumberFormat("en-US", {
                        style: "currency",
                        currency: "USD",
                      }).format(context.parsed.y);
                    }
                    return label;
                  },
                },
              },
            },
          },
        });
      }

      // Initial calculation
      calculateCompoundInterest();
    </script>
  </body>
</html>
